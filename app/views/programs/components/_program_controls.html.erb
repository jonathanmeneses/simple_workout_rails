<!-- app/views/programs/components/_program_controls.html.erb -->
<div class="w-full max-w-4xl bg-white rounded-xl shadow p-6 mb-6">
  <h2 class="font-semibold text-lg mb-4">Program Controls</h2>
  <%= form_with url: program_path(@selected_program_id), method: :get, local: true, class: "space-y-4" do |form| %>
    <!-- Program Selector -->
    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
      <div>
        <label class="block text-sm font-medium text-gray-700 mb-2">Program</label>
        <%= form.select :id, options_for_select(@program_options, @selected_program_id.to_s), 
              { prompt: "Select Program" }, 
              { class: "w-full border border-gray-300 rounded-lg px-3 py-2", 
                onchange: "this.form.submit();" } %>
      </div>
      <!-- Cycle Selector -->
      <div>
        <label class="block text-sm font-medium text-gray-700 mb-2">Cycle</label>
        <%= form.select :cycle, options_for_select(@cycle_options || [], @selected_cycle_index), 
              { prompt: "Select Cycle" }, 
              { class: "w-full border border-gray-300 rounded-lg px-3 py-2", 
                onchange: "this.form.submit();",
                disabled: @cycle_options.blank? } %>
      </div>
      <!-- Week Selector - only show if single_week mode -->
      <div>
        <label class="block text-sm font-medium text-gray-700 mb-2">
          <%= @view_mode == "single_week" ? "Day/Session" : "View Mode" %>
        </label>
        <% if @view_mode == "single_week" && @week_options&.any? %>
          <%= form.select :week, options_for_select(@week_options, @selected_day_index), 
                { prompt: "Select Day" }, 
                { class: "w-full border border-gray-300 rounded-lg px-3 py-2", 
                  onchange: "this.form.submit();" } %>
        <% else %>
          <div class="text-sm text-gray-500 py-2">
            <%= @view_mode == "full_cycle" ? "Showing Full Cycle" : "Select single week mode" %>
          </div>
        <% end %>
      </div>
    </div>
    <!-- View Mode Toggle -->
    <div>
      <label class="block text-sm font-medium text-gray-700 mb-2">View Mode</label>
      <div class="flex gap-2">
        <%= form.radio_button :view_mode, "full_cycle", 
            checked: @view_mode == "full_cycle", 
            class: "sr-only", 
            onchange: "this.form.submit();" %>
        <%= form.label :view_mode_full_cycle, "Full Cycle", 
            class: "px-4 py-2 rounded-lg border transition-colors #{@view_mode == 'full_cycle' ? 'bg-blue-500 text-white border-blue-500' : 'bg-white text-gray-700 border-gray-300 hover:bg-gray-50'} cursor-pointer" %>
        <%= form.radio_button :view_mode, "single_week", 
            checked: @view_mode == "single_week", 
            class: "sr-only", 
            onchange: "this.form.submit();" %>
        <%= form.label :view_mode_single_week, "Single Week", 
            class: "px-4 py-2 rounded-lg border transition-colors #{@view_mode == 'single_week' ? 'bg-blue-500 text-white border-blue-500' : 'bg-white text-gray-700 border-gray-300 hover:bg-gray-50'} cursor-pointer" %>
      </div>
    </div>
  <% end %>
</div>