<div class="min-h-screen bg-white flex flex-col items-center py-12">
  <div class="w-full max-w-4xl bg-white rounded-xl shadow p-8">
    
    <!-- Header -->
    <div class="mb-6">
      <h1 class="font-bold text-2xl mb-2 text-primary"><%= @program.name %></h1>
      <p class="text-gray-500 mb-4"><%= @program.description %></p>
      <%= link_to "← Back to Programs", programs_path, class: "text-blue-600 hover:text-blue-800 text-sm" %>
    </div>

    
    <%= turbo_frame_tag "program_content" do %>
    <!-- View Mode Controls -->
    <div class="mb-6">
      <div class="flex gap-2 border-b border-gray-200">
        
        <%= link_to "Description", 
            program_path(@program, view_mode: 'description'), 
            class: "px-4 py-2 text-sm font-medium border-b-2 #{'border-blue-500 text-blue-600' if @view_mode == 'description'} #{'border-transparent text-gray-500 hover:text-gray-700' unless @view_mode == 'description'}",
            data: { turbo_frame: "program_content" } %>
        
        <!-- Program Tab (NEW: Turbo way!) -->
        <%= link_to "Program", 
            program_path(@program, view_mode: 'program', cycle: @selected_cycle), 
            class: "px-4 py-2 text-sm font-medium border-b-2 #{'border-blue-500 text-blue-600' if @view_mode == 'program'} #{'border-transparent text-gray-500 hover:text-gray-700' unless @view_mode == 'program'}",
            data: { turbo_frame: "program_content" } %>
        
        <!-- Schedule Tab (old way) -->
        <%= link_to "Schedule",
            program_path(@program, view_mode: 'schedule'),
            class: "px-4 py-2 text-sm font-medium border-b-2 #{'border-blue-500 text-blue-600' if @view_mode == 'schedule'} #{'border-transparent text-gray-500 hover:text-gray-700' unless @view_mode == 'schedule'}",
            data: { turbo_frame: "program_content" } %>

    </div>

    <!-- TURBO FRAME: Fast updates for Program tab -->
    
      
      <!-- Cycle Selector (only shows in program mode) -->
      <% if @view_mode == 'program' %>
        <div class="mb-6">
          <label class="block text-sm font-medium text-gray-700 mb-2">Select Cycle:</label>
          
          <%= form_with url: program_path(@program), 
                        method: :get, 
                        local: false,
                        data: { turbo_frame: "program_content" },
                        id: "cycle_form" do |f| %>
            <%= f.hidden_field :view_mode, value: 'program' %>
            <%= f.select :cycle, 
                options_from_collection_for_select(@program.workout_cycles, :name, :name, @selected_cycle),
                {},
                { 
                  class: "border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",
                  onchange: "this.form.requestSubmit();"
                } %>
          <% end %>
        </div>
      <% end %>

      <!-- Content Area -->
      <%= render partial: "program_content" %>
      
    <% end %>

    <footer class="text-center text-gray-400 text-sm mt-8">
      Workout Program Generator © 2025 &bull; <a href="#" class="underline">About</a> &bull; <a href="#" class="underline">Movement Reference</a>
    </footer>
  </div>
</div>